# Оптимизация сайта lifehacker.ru

## Общие замечания по ресурсам

- некоторые картинки, скрипты и стили минимизированы, некоторые нет
- Загружаются ненужные для работы страницы ресурсы
  - 91% правил стилей не используются
  - средний coverage скриптов ~50%
- Не объединены в один файл
  - плагины wordpress
  - другие скрипты и стили

## Загрузка и кэширование ресурсов

- стили инлайн после внешних стилей, а внешние после скриптов
- странное время хранения ресурсов в заголовках, т.к. ресурсы имеют **query** опции `?ver=num`, выставление срока хранение в 24 часа неразумно - можно  больше, т.к. если версия обновится, загрузится другой ресурс
- у некоторых файлов вообще выставлено кэширование на очень маленький срок и не используется **gzip**
- используется один домен для загрузки ресурсов c куки файлами
- общее число запросов очень велико, а сама страница весит недопустимо много
- большое количество редиректов
- некоторые изображения которые находятся за областью отрисовки не загружаются ленивой загрузкой, хотя она реализована
- в браузерах, где доступен **http2** не используется данный протокол
- выводится запрос об уведомлениях во время загрузки

## Мобильная оптимизация

- не используются **service-workers**
- не используются инлайн стили для каждого блока
- мобильная версия лишь грузит уменьшенные изображения, но тащит все библиотеки и стили основного сайта

## Немного статистики

|Сайт|Meaningful (D)|Meaningful (M)|Full (D)|Full (M)|
|---|---|---|---|---|
|lifehacker.ru|3.85s|9.96s|5.3s|16.37s|

### Примечания

- **(M)obile** - Nexus 5X, Regular 3G
- **(D)esktop** - MacBook Pro 2015,  Yandex Wi-Fi

## Выводы

1. Минимизировать и сжимать ресурсы
1. Использовать **HTTP2** и несколько **CDN** для параллельной загрузки без **cookie** файлов
1. Разобраться со сроком кэширования файлов
1. Организовать сборку стилей и скриптов в один файл с помощью **webpack**
1. Сделать **first meaningful paint bundle** (все что нужно для первой отрисовки выбрать, а остальное грузить в фоне)
1. Сделать отдельную мобильную версию, хоть это и сложно в плане **CEO**
1. Уменьшить количество редиректов
1. Добавить **Expires, Accept-Encoding** заголовки
